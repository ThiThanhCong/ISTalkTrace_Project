import os

import numpy as np
import torch
import torch.nn as nn
import torch.optim as optim
import torchaudio
from speechbrain.inference.classifiers import EncoderClassifier


class SpeakerRNN(nn.Module):
    def __init__(self, input_dim, hidden_dim, output_dim, num_layers=2):
        super(SpeakerRNN, self).__init__()
        self.gru = nn.GRU(input_dim, hidden_dim, num_layers, batch_first=True)
        self.fc = nn.Linear(hidden_dim, output_dim)

    def forward(self, x):
        out, _ = self.gru(x)
        out = self.fc(out[:, -1, :])
        return out


def time_to_seconds(timestamp):
    h, m, s = map(int, timestamp.split(":"))
    return h * 3600 + m * 60 + s

def load_script(script_path):
    segments, speakers = [], []
    with open(script_path, "r", encoding="utf-8") as file:
        for line in file:
            start, end, speaker = line.strip().split()
            segments.append((time_to_seconds(start), time_to_seconds(end)))
            speakers.append(speaker)
    return segments, speakers


def extract_xvectors(audio_path, segments, classifier):
    waveform, sample_rate = torchaudio.load(audio_path)
    xvector_dict = {}

    for (start, end), speaker in segments:
        start_sample = int(start * sample_rate)
        end_sample = int(end * sample_rate)
        segment_waveform = waveform[:, start_sample:end_sample]

        with torch.no_grad():
            embedding = classifier.encode_batch(segment_waveform).squeeze().numpy()

        if speaker not in xvector_dict:
            xvector_dict[speaker] = []
        xvector_dict[speaker].append(embedding)

    return xvector_dict


def train_rnn_for_speaker(speaker, xvectors, num_epochs=50):
    xvectors = np.mean(xvectors, axis=1)
    input_dim = xvectors.shape[1]
    hidden_dim = 128
    output_dim = 1

    model = SpeakerRNN(input_dim, hidden_dim, output_dim)
    criterion = nn.MSELoss()
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    x_train = torch.tensor(xvectors, dtype=torch.float32).unsqueeze(1)
    print(f"x_train shape: {x_train.shape}")

    y_train = torch.ones((len(xvectors), 1), dtype=torch.float32)  # Dummy labels

    for epoch in range(num_epochs):
        optimizer.zero_grad()
        outputs = model(x_train)
        loss = criterion(outputs, y_train)
        loss.backward()
        optimizer.step()

    os.makedirs("rnn_xvector_models", exist_ok=True)

    torch.save({
        "input_dim": input_dim,
        "model_state_dict": model.state_dict()
    }, f"rnn_xvector_models/{speaker}.pth")

    print(f"✅ Đã lưu mô hình RNN cho {speaker}")


def load_rnn_model(speaker, input_dim):
    model_path = f"rnn_xvector_models/{speaker}.pth"
    if not os.path.exists(model_path):
        print(f"⚠️ Không tìm thấy mô hình cho {speaker}")
        return None

    checkpoint = torch.load(model_path)  # Load toàn bộ checkpoint
    input_dim = checkpoint["input_dim"]  # Lấy input_dim từ file lưu trước đó

    model = SpeakerRNN(input_dim, hidden_dim=128, output_dim=1)
    model.load_state_dict(checkpoint["model_state_dict"])
    model.eval()
    return model


# def predict_speaker(speaker, xvectors):
#     model = load_rnn_model(speaker, xvectors.shape[1])
#     if model is None:
#         return []
#
#     x_test = torch.tensor(np.array(xvectors), dtype=torch.float32).unsqueeze(1)
#     with torch.no_grad():
#         predictions = model(x_test).numpy()
#
#     return predictions

#
# audio_file = "train_voice/raw/raw.wav"
# script_file = "train_voice/raw/script.txt"
#
# classifier = EncoderClassifier.from_hparams(source="speechbrain/spkrec-xvect-voxceleb", run_opts={"device": "cpu"})
#
# segments, speakers = load_script(script_file)
# xvector_dict = extract_xvectors(audio_file, zip(segments, speakers), classifier)
#
# for speaker, xvectors in xvector_dict.items():
#     train_rnn_for_speaker(speaker, xvectors)

# -------------------Test model-------------------#
#
# def load_rnn_model(speaker, input_dim):
#     model_path = f"rnn_xvector_models/{speaker}.pth"
#     if not os.path.exists(model_path):
#         print(f"⚠️ Không tìm thấy mô hình cho {speaker}")
#         return None
#
#     model = SpeakerRNN(input_dim, hidden_dim=128, output_dim=1)
#     model.load_state_dict(torch.load(model_path))
#     model.eval()
#     return model

def predict_speaker(speaker, xvectors):
    xvectors = np.array(xvectors)
    model = load_rnn_model(speaker, xvectors.shape[1])
    if model is None:
        return []

    x_test = torch.tensor(np.array(xvectors), dtype=torch.float32)

    if len(x_test.shape) == 2:
        x_test = x_test.unsqueeze(1)

    with torch.no_grad():
        predictions = model(x_test).numpy()

    return predictions

def test_speaker_recognition(audio_file, script_file):
    classifier = EncoderClassifier.from_hparams(source="speechbrain/spkrec-xvect-voxceleb", run_opts={"device": "cpu"})
    segments, speakers = load_script(script_file)
    xvector_dict = extract_xvectors(audio_file, zip(segments, speakers), classifier)

    for speaker, xvectors in xvector_dict.items():
        predictions = predict_speaker(speaker, xvectors)
        # print(f""{speaker}: {predictions})"")

audio_file = "train_voice/raw/raw.wav"
script_file = "train_voice/raw/script.txt"
# test_speaker_recognition(audio_file, script_file)

def calculate_accuracy(true_labels, predicted_scores):
    """
    true_labels: Danh sách nhãn thực tế của speakers (vd: ["A", "M", "T", "K"])
    predicted_scores: Dict chứa danh sách các giá trị dự đoán cho từng speaker
    """
    predicted_labels = []

    # Chuyển đổi từ điểm số thành nhãn dự đoán
    for i in range(len(true_labels)):
        max_score = -np.inf
        best_speaker = None

        for speaker, scores in predicted_scores.items():
            # Flatten the scores if they are nested lists
            flattened_scores = np.array(scores).flatten()

            # Make sure the index i is within the bounds of the flattened list
            if i < len(flattened_scores) and flattened_scores[i] > max_score:
                max_score = flattened_scores[i]
                best_speaker = speaker

        predicted_labels.append(best_speaker)

    # Tính accuracy
    correct_predictions = sum(1 for i in range(len(true_labels)) if true_labels[i] == predicted_labels[i])
    accuracy = correct_predictions / len(true_labels) * 100

    return accuracy

true_labels = ["nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"nguyenminhnhut",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"tranvubao",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"phanthanhcong",
"phanthanhcong",
"phanthanhcong",
"nguyendinhthuan",
"nguyendinhthuan",
"phanthanhcong",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"lebadac",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"lebadac",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenthanhquynhtien",
"nguyenthanhquynhtien",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"lenguyengiahung",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyentoankhang",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"duonglytuyetmai",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyentoankhang",
"nguyentoankhang",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"hongoctuongvy",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"ngothuanphat",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"hongoctuongvy",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"daotrongnghia",
"nguyenminhnhut",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"domainhuquynh",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyenminhnhut",
"nguyenhuythuc",
"nguyenhuythuc",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"lethuanhieu",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"lethuanhieu",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"phamthithuytrang",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenthivananh",
"nguyenthivananh","nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyenthivananh",
"nguyendinhthuan",
"nguyenthivananh",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenthivananh",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyenminhnhut",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan",
"nguyendinhthuan"]

predicted_scores = {
    "nguyendinhthuan": [[1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.590392],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903883],
                        [1.5903882],
                        [1.590388],
                        [1.5903881],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.5903887],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903889],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.5903882],
                        [1.5903916],
                        [1.5903881],
                        [1.5903883],
                        [1.590388],
                        [1.590388],
                        [1.5903884],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.59039],
                        [1.59064],
                        [1.5903884],
                        [1.5903908],
                        [1.5903958],
                        [1.590388],
                        [1.590388],
                        [1.590393],
                        [1.5903881],
                        [1.5903881],
                        [1.590388],
                        [1.5903882],
                        [1.590388],
                        [1.5903881],
                        [1.5911669],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903891],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903975],
                        [1.5903894],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.5903976],
                        [1.590388],
                        [1.590388],
                        [1.5904626],
                        [1.5903894],
                        [1.5903901],
                        [1.5903898],
                        [1.5904454],
                        [1.5903881],
                        [1.5903887],
                        [1.5903882],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5965785],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903925],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903903],
                        [1.5903889],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590399],
                        [1.590388],
                        [1.5903889],
                        [1.5903934],
                        [1.5903882],
                        [1.590388],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.590388],
                        [1.5903925],
                        [1.5903881],
                        [1.590388],
                        [1.5904142],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.5903882],
                        [1.5903884],
                        [1.590388],
                        [1.5903887],
                        [1.590388],
                        [1.5903882],
                        [1.5903893],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.590388],
                        [1.5903884],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.5903913],
                        [1.5903881],
                        [1.5903887],
                        [1.590388],
                        [1.590388],
                        [1.5903882],
                        [1.590388],
                        [1.5903884],
                        [1.5903881],
                        [1.590388],
                        [1.590388],
                        [1.5903885],
                        [1.5903881],
                        [1.5903882],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.590388],
                        [1.5903881],
                        [1.590388],],
    "nguyenminhnhut": [[1.4651057],
                       [1.4651054],
                       [1.4651053],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651059],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651057],
                       [1.4651054],
                       [1.4651057],
                       [1.4651055],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651055],
                       [1.4651054],
                       [1.4651058],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],
                       [1.4651054],],
    "phanthanhcong": [[1.4370725],
                      [1.4216713],
                      [1.4171671],
                      [1.4144319],
                      [1.4144325],
                      [1.4342439],
                      [1.4144316],
                      [1.4370652],
                      [1.4366503],
                      [1.4155293],
                      [1.4370593],
                      [1.4144316],
                      [1.4369748],
                      [1.4144316],
                      [1.4369898],
                      [1.437073],
                      [1.4149084],
                      [1.4370092],
                      [1.4370722],
                      [1.4370738],
                      [1.4370737],
                      [1.437073],
                      [1.4370708],
                      [1.4370725],
                      [1.4370735],
                      [1.4370725],
                      [1.4370778],
                      [1.4370759],
                      [1.4370742],
                      [1.4370594],
                      [1.437063],
                      [1.4370737],
                      [1.4370747],
                      [1.4370801],
                      [1.4370742],
                      [1.4369457],
                      [1.4370731],
                      [1.4370728],
                      [1.4370885],
                      [1.4370776],
                      [1.4370732],
                      [1.4370985],
                      [1.4370592],
                      [1.4370747],
                      [1.4370718],
                      [1.4370751],
                      [1.4370737],
                      [1.4370733],
                      [1.437073],
                      [1.4370729],
                      [1.4370761],
                      [1.4144316],
                      [1.437073],
                      [1.4342626],
                      [1.43707],
                      [1.4144355],
                      [1.4370078],
                      [1.4153597],
                      [1.4144316],
                      [1.4370587],
                      [1.4367099],
                      [1.4363518],],
    "tranvubao": [[1.4761536],
                  [1.4756579],
                  [1.4764504],
                  [1.476169],
                  [1.4761517],
                  [1.4761592],
                  [1.4761515],
                  [1.4761628],
                  [1.4740396],
                  [1.4761562],
                  [1.4773062],
                  [1.4761536],
                  [1.4761522],
                  [1.4761522],
                  [1.4761517],
                  [1.4761463],
                  [1.4761528],
                  [1.476152],
                  [1.476152],
                  [1.4761516],
                  [1.4761521],
                  [1.4761589],
                  [1.476177],
                  [1.476152],
                  [1.4761517],
                  [1.4761521],
                  [1.4761517],
                  [1.4761543],
                  [1.4761521],
                  [1.4761521],
                  [1.476152],
                  [1.4761565],
                  [1.476152],
                  [1.4761517],
                  [1.4761517],
                  [1.476152],
                  [1.4789925],
                  [1.4761543],
                  [1.4761517],
                  [1.4761533],
                  [1.4761522],
                  [1.476152],
                  [1.476152],
                  [1.4761528],],
    "lebadac": [[1.4600427],
                [1.4600425],
                [1.4600427],
                [1.4600425],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600425],
                [1.4600425],
                [1.4600425],
                [1.4600425],
                [1.4600427],
                [1.4600425],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600425],
                [1.4600427],
                [1.4600427],
                [1.4600427],
                [1.4600425],
                [1.4600425],
                [1.4600425],
                [1.4600425],
                [1.4600427],
                [1.4600427],
                [1.4600425],
                [1.4600427],],
    "nguyenthanhquynhtien": [[1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805754],
                             [1.4805753],
                             [1.4805753],
                             [1.4805754],
                             [1.4805753],
                             [1.4805757],
                             [1.4805757],
                             [1.4805753],
                             [1.4805753],
                             [1.4805752],
                             [1.4805754],
                             [1.4805752],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805753],
                             [1.4805759],
                             [1.4805753],
                             [1.4805754],
                             [1.4805753],
                             [1.4805752],
                             [1.4805752],
                             [1.4805753],
                             [1.4805754],
                             [1.4805753],
                             [1.4805754],
                             [1.4805762],
                             [1.4805753],
                             [1.4805754],
                             [1.4805753],
                             [1.4805764],
                             [1.4805754],
                             [1.4805753],
                             [1.4805754],
                             [1.4805754],
                             [1.4805757],
                             [1.4805753],
                             [1.4805754],
                             [1.4805752],
                             [1.4805783],
                             [1.4805754],],
    "lenguyengiahung": [[1.4811417],
                        [1.4801037],
                        [1.4804128],
                        [1.4800843],
                        [1.479981],
                        [1.4801528],
                        [1.4803067],
                        [1.4823102],
                        [1.48197],
                        [1.4806231],
                        [1.4809524],
                        [1.4804549],
                        [1.4802334],
                        [1.4804386],
                        [1.4804485],
                        [1.4832306],
                        [1.4803249],
                        [1.4828222],
                        [1.4805369],
                        [1.4803127],
                        [1.4800205],
                        [1.481457],
                        [1.4805123],
                        [1.4804926],
                        [1.4839042],
                        [1.4835556],
                        [1.4808607],
                        [1.4834294],
                        [1.4823155],
                        [1.4804639],
                        [1.48015],
                        [1.4801633],
                        [1.4800358],
                        [1.4812722],
                        [1.4801277],
                        [1.4802853],
                        [1.4801049],
                        [1.4803121],
                        [1.4804244],
                        [1.4821239],
                        [1.4800768],
                        [1.4802669],
                        [1.4802183],
                        [1.4801092],
                        [1.4800279],
                        [1.4802256],
                        [1.4801819],
                        [1.4843423],
                        [1.4813],
                        [1.4800406],
                        [1.4800274],
                        [1.4806485],
                        [1.4820403],
                        [1.4828634],
                        [1.4801575],
                        [1.4800571],
                        [1.4802811],
                        [1.4814998],
                        [1.4800894],
                        [1.4810295],
                        [1.4800377],
                        [1.4806037],
                        [1.4806348],
                        [1.4816828],
                        [1.4806638],
                        [1.4801402],
                        [1.4800541],
                        [1.4809859],
                        [1.4800947],
                        [1.4801705],
                        [1.4800798],
                        [1.4809949],
                        [1.4814098],
                        [1.4802905],
                        [1.4811792],
                        [1.4848026],
                        [1.4801476],
                        [1.482254],
                        [1.480184],
                        [1.4847255],
                        [1.4829814],],
    "duonglytuyetmai": [[1.5100361],
                        [1.5100361],
                        [1.5100362],
                        [1.5100362],
                        [1.5100361],
                        [1.5100359],
                        [1.5100361],
                        [1.5100361],
                        [1.5100362],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100363],
                        [1.5100362],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100362],
                        [1.5100363],
                        [1.5100362],
                        [1.5100363],
                        [1.5100361],
                        [1.5100361],
                        [1.5100363],
                        [1.5100361],
                        [1.5100361],
                        [1.5100362],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100361],
                        [1.5100062],
                        [1.5100299],
                        [1.5100361],],
    "nguyentoankhang": [[1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215341],
                        [1.4215341],
                        [1.4215341],
                        [1.4215341],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215342],
                        [1.4215341],
                        [1.4215341],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215341],
                        [1.4215341],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215341],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],
                        [1.4215342],],
    "hongoctuongvy": [[1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332469],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332469],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332469],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332472],
                      [1.4332467],
                      [1.4332467],
                      [1.4332466],
                      [1.4332466],
                      [1.4332467],
                      [1.4332466],
                      [1.4332466],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],
                      [1.4332467],],
    "ngothuanphat": [[1.5210593],
                     [1.5210493],
                     [1.5210514],
                     [1.5210378],
                     [1.521076],
                     [1.521094],
                     [1.5211382],
                     [1.5210683],
                     [1.5210422],
                     [1.5210371],
                     [1.5210388],
                     [1.5210487],
                     [1.5210567],
                     [1.5210459],
                     [1.5210478],
                     [1.5210522],
                     [1.5210528],
                     [1.5210423],
                     [1.5210449],
                     [1.5210582],
                     [1.5210693],],
    "daotrongnghia": [[1.4366246],
                      [1.4366089],
                      [1.4366089],
                      [1.4366032],
                      [1.4366044],
                      [1.4366064],
                      [1.4366001],
                      [1.4366013],
                      [1.4366016],
                      [1.4366012],
                      [1.4366008],
                      [1.4365959],
                      [1.4365829],
                      [1.4366022],
                      [1.4366045],
                      [1.436602],
                      [1.4366027],
                      [1.4366025],
                      [1.4366028],
                      [1.4365995],
                      [1.436601],
                      [1.4366143],
                      [1.436601],
                      [1.436603],
                      [1.4366018],],
    "domainhuquynh": [[1.4906018],
                      [1.5003806],
                      [1.5003812],
                      [1.5003809],
                      [1.5003811],
                      [1.500381],
                      [1.500381],
                      [1.5003799],
                      [1.5003809],
                      [1.5003809],
                      [1.5003802],
                      [1.5003806],
                      [1.5003809],
                      [1.5003805],
                      [1.500381],
                      [1.5003809],
                      [1.5003808],
                      [1.5003809],
                      [1.5003687]],
    "nguyenhuythuc": [[1.4697437],
                      [1.4697927],
                      [1.4697636],
                      [1.4697452],
                      [1.4697454],
                      [1.4702913],
                      [1.4697429],
                      [1.4697441],
                      [1.4697453],
                      [1.4697435],
                      [1.4697436],
                      [1.4697431],
                      [1.4697466],
                      [1.4697433],
                      [1.4697428],
                      [1.4697446],
                      [1.4697433],
                      [1.4697434],
                      [1.4697434],
                      [1.4697452],
                      [1.4697442],
                      [1.469743],
                      [1.469744],
                      [1.4697472],
                      [1.469746],
                      [1.4698836],
                      [1.4699448],],
    "lethuanhieu": [[1.4789085],
                    [1.4789082],
                    [1.4789089],
                    [1.4788915],
                    [1.47891],
                    [1.4789097],
                    [1.4789094],
                    [1.4789081],
                    [1.4789083],
                    [1.4788983],
                    [1.4789081],
                    [1.4789083],
                    [1.4789085],
                    [1.4789085],
                    [1.4789083],
                    [1.4789099],
                    [1.4788983],
                    [1.4789083],
                    [1.4789042],
                    [1.4788959],
                    [1.4789169],
                    [1.4789081],
                    [1.4789106],
                    [1.4789084],
                    [1.4789071],
                    [1.4789081],
                    [1.4789134],
                    [1.4784682],
                    [1.4789019],
                    [1.4789083],
                    [1.4789073],
                    [1.4789082],
                    [1.4789083],
                    [1.4789077],
                    [1.4789073],
                    [1.4789045],
                    [1.4789083],
                    [1.4789077],
                    [1.4789085],
                    [1.4789081],
                    [1.4789084],
                    [1.4789083],
                    [1.4789068],
                    [1.4789072],
                    [1.4789082],
                    [1.4788967],
                    [1.4788686],
                    [1.4789082],
                    [1.4789087],
                    [1.4789081],
                    [1.4788855],
                    [1.4788693],
                    [1.4788644],
                    [1.4788945],
                    [1.4789082],
                    [1.4789042],
                    [1.4788783],
                    [1.478904],
                    [1.4788942],
                    [1.4789051],
                    [1.4789072],
                    [1.4789003],
                    [1.4789014],
                    [1.4789081],
                    [1.478905],
                    [1.4789045],
                    [1.4788421],
                    [1.478899],
                    [1.4789087],
                    [1.4789089],
                    [1.4789082],
                    [1.4789082],
                    [1.4789083],
                    [1.4789076],
                    [1.4789058],
                    [1.4789029],
                    [1.4789007],
                    [1.4788815],
                    [1.4789057],
                    [1.4789071],
                    [1.4789083],
                    [1.4789083],
                    [1.4789057],
                    [1.4789367],
                    [1.478919],
                    [1.4789068],
                    [1.4789082],
                    [1.4789083],
                    [1.4789082],
                    [1.4789084],
                    [1.4789082],
                    [1.478894],
                    [1.4789081],
                    [1.4788961],
                    [1.4789083],
                    [1.4789081],
                    [1.4789078],
                    [1.4789004],
                    [1.4789095],
                    [1.4789048],
                    [1.4788816],
                    [1.4789002],
                    [1.4788964],
                    [1.4789082],
                    [1.4789014],
                    [1.4789081],
                    [1.4789114],
                    [1.4789081],
                    [1.4789084],
                    [1.4789082],
                    [1.4736215],
                    [1.4789022],
                    [1.4789059],
                    [1.4789081],
                    [1.4789085],
                    [1.4789088],
                    [1.478905],
                    [1.4788984],
                    [1.4789083],
                    [1.4788911],
                    [1.4789073],
                    [1.4789002],
                    [1.4789081],
                    [1.4789065],
                    [1.478884],
                    [1.478906],
                    [1.4789082],
                    [1.4789035],
                    [1.4788756],
                    [1.478888],
                    [1.4789082],
                    [1.4789064],
                    [1.4788978],
                    [1.4789054],
                    [1.4788287],
                    [1.4789068],
                    [1.4789037],
                    [1.4788936],
                    [1.4788687],
                    [1.4788969],
                    [1.4789064],
                    [1.4789076],
                    [1.478894],
                    [1.4789076],
                    [1.4788929],
                    [1.4789083],
                    [1.4789083],
                    [1.478901],
                    [1.4789082],
                    [1.4789072],
                    [1.4789069],
                    [1.4788985],
                    [1.478902],
                    [1.4789082],
                    [1.4789081],
                    [1.4787347],
                    [1.4789033],
                    [1.4788904],
                    [1.4789081],
                    [1.4789083],
                    [1.4789114],
                    [1.4791927],
                    [1.4789082],
                    [1.4776504],
                    [1.4791102],
                    [1.4789141],
                    [1.4796956],
                    [1.4788927],
                    [1.4789082],
                    [1.4789088],
                    [1.47891],
                    [1.4788857],
                    [1.4789076],
                    [1.4789084],
                    [1.4789066],
                    [1.4789081],
                    [1.4790487],
                    [1.4789075],
                    [1.4789082],
                    [1.4763689],
                    [1.4788795],
                    [1.4789085],
                    [1.4789],
                    [1.4789864],
                    [1.478847],
                    [1.4789051],
                    [1.4788548],
                    [1.4789094],
                    [1.478906],
                    [1.4789785],
                    [1.478909],
                    [1.4789083],
                    [1.4789112],
                    [1.4787806],
                    [1.478879],
                    [1.4788928],
                    [1.4789081],
                    [1.4789085],
                    [1.478882],
                    [1.4789082],
                    [1.4789082],
                    [1.4788997],
                    [1.4789004],
                    [1.4788895],
                    [1.4789062],
                    [1.4786458],
                    [1.4788781],
                    [1.4788969],
                    [1.4789081],
                    [1.4789028],
                    [1.4789],
                    [1.4788558],
                    [1.4788809],
                    [1.4788964],
                    [1.4788909],
                    [1.4788879],
                    [1.4789072],
                    [1.4788698],
                    [1.4789081],
                    [1.4788947],
                    [1.4788927],
                    [1.4789078],
                    [1.4789083],
                    [1.4789059],
                    [1.4789094],
                    [1.4789082],
                    [1.4789026],
                    [1.4788859]],
    "phamthithuytrang": [[1.4864748],
                         [1.4864748],
                         [1.4864746],
                         [1.4864746],
                         [1.4864748],
                         [1.4864746],
                         [1.4864748],
                         [1.4864746],
                         [1.4864746],
                         [1.4864746],
                         [1.4864748],
                         [1.4864746],
                         [1.4864746],
                         [1.4864746],
                         [1.4864746],
                         [1.4864746],
                         [1.4864748],
                         [1.4864746],
                         [1.4864748],
                         [1.4864746],
                         [1.486501],
                         [1.4864746]],
    "nguyenthivananh": [[1.4002912],
                        [1.4002931],
                        [1.4002917],
                        [1.4002917],
                        [1.4002924],
                        [1.4002914],
                        [1.4002917],
                        [1.4002929],
                        [1.4002936],
                        [1.4002917],
                        [1.4002926],
                        [1.4002914],
                        [1.4002917],
                        [1.4002917],
                        [1.4002914],
                        [1.4002948],
                        [1.4002934],
                        [1.4002914],
                        [1.4002967],
                        [1.4002974],
                        [1.4002926],
                        [1.4002955],
                        [1.4002926],
                        [1.4002919],
                        [1.4002926],
                        [1.4002955],
                        [1.4002914],
                        [1.4002914],
                        [1.4002912],
                        [1.4002912],
                        [1.4002922],]
}

for key in predicted_scores:
    predicted_scores[key] = np.array(predicted_scores[key]).flatten()

accuracy = calculate_accuracy(true_labels, predicted_scores)
print(f"🎯 Accuracy: {accuracy:.2f}%")

# 2.57
